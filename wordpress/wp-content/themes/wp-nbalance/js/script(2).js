!function(t){t.add2basket=function(e,s,i){var a=this;a.options=t.extend({ajaxURL:"/ajax/add2basket.php",onSuccess:function(t){},onError:function(t){}},e),a.init=function(){if(i.id=parseInt(i.id)){try{rrApi.addToBasket(i.id)}catch(t){}(i.quantity=parseInt(i.quantity))||(i.quantity=1);var e={data:{quantity:i.quantity,id:i.id},url:a.options.ajaxURL};switch(i.iblock_id>0&&(e.data.iblock_id=i.iblock_id),i.offer_id>0&&(e.data.offer_id=i.offer_id),void 0!==i.basket_props&&(e.data.basket_props=i.basket_props),s){case"delete":e.data["delete"]="Y"}return a._ajaxRequest(e)}},a._ajaxRequest=function(e){null!=a.checkAjax&&a.checkAjax.abort(),a.checkAjax=t.ajax({data:e.data,url:e.url,type:"POST",dataType:"json",success:function(t){return a.options.onSuccess.call(arguments,t),t},error:function(t){return a.options.onError.call(arguments,t),!1}})},a.init()}}(jQuery),function(t){t.fn.owManageBasketButton=function(e,s){var i=this;return i.init=function(e){return this.each(function(){i.UI=t.extend({button:"#js-product-basket-button",product:"#js-product-block",quantity:"#js-product-quantity",title:".js-product-basket-title",text:{active:"в корзине","default":"в корзину"},"class":{"default":"",active:"active",ajax:"adding",not_available:"item__notavail"}},e.UI),i.options=t.extend({url:"/ajax/add2basket.php",refreshBasketLine:!0,offers:!1,detail:!1,useQuantity:!1,onGetResult:function(t,e){}},e.opts),i.checkAjax=null,i.on("click",i.UI.button,function(e){return!(!t(this).hasClass(i.UI["class"].active)&&!t(this).hasClass(i.UI["class"].not_available))||(e.preventDefault(),void i._add(t(this)))})})},i._add=function(t){var e=t.closest(i.UI.product),s=parseInt(e.data("productId"));i.options.detail?t.removeClass(i.UI["class"]["default"]).addClass(i.UI["class"].active).find(i.UI.title).text(i.UI.text.active):t.addClass(i.UI["class"].active).find(i.UI.title).text(i.UI.text.active);var a=1;i.options.useQuantity&&(a=parseInt(e.find(i.UI.quantity).val()));var n={id:s,quantity:a};e.data("offers")&&(n.iblock_id=e.data("iblock"),n.basket_props=e.data("basketProps")),i._ajaxRequest(n,"add")},i._ajaxRequest=function(e,s){var a=i.options;t(i.UI.button,i).addClass(i.UI["class"].ajax),t.add2basket({onSuccess:function(s){t(i.UI.button,i).removeClass(i.UI["class"].ajax),i.options.refreshBasketLine&&BX.onCustomEvent("OnBasketChange"),a.onGetResult.call(arguments,e.id,s.quantity)},onError:function(e){t(i.UI.button,i).removeClass(i.UI["class"].ajax)}},s,e)},"string"==typeof e&&"_"!=e[0]&&"function"==typeof i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:i.init.apply(this,arguments)}}(jQuery);var imgLoaded=function(t){$(document).trigger("imgLoaded",{type:t})};!function(t){t.fn.owManageSKU=function(e,s){var i=this;return i.init=function(e){return this.each(function(){i.UI=t.extend({offers:{block:".js-product-offer-prop",item:".js-product-offer-prop-item"},props:".js-display-prop-",basket:{block:"#js-product-button-block",blockInShops:"#js-product-button-block_inshop",button:"#js-product-basket-button",quantity:"#js-product-quantity",cAdded:"active",title:".js-product-basket-title",cAjax:"adding",quickOrder:"#js-product-quick-order",quickReserved:"#js-quick-reserve"},quantity:{input:"#js-product-quantity",selector:".js-quantity-selector",item:".js-quantity-selector-item",display:".js-quantity-display-value"},slider:{container:"#js-slider",wrapper:"#js-slider-wrapper"},thumb:"#js-product-thumbs",notAvailable:"#js-product-not-available"},e.UI),i.settings=t.extend({checkedProps:{},checkedOffer:0,inBasket:{},defaultMaxQuantity:10},e.opts),i.swiper=i._initGallerySlider(),i.on("click",i.UI.offers.item,function(){i._changeProp(t(this))}),i.on("click",i.UI.quantity.item,function(){i._selectQuantity(t(this))}),i.on("click",i.UI.basket.quickOrder,function(e){i._buyOneClick(t(this))}),i.on("click",i.UI.basket.quickReserved,function(e){i._reserveClick(t(this))}),i.owSelectorsAction(),t(window).resize(function(){i._itemSliderSetHeightByImage()}),t(document).on("imgLoaded",function(t,e){"detail"==e.type?i._detailLoaded():i._previewLoaded()})})},i.addData=function(e){return this.each(function(){if(i.settings.checkedProps={},i.settings=t.extend(i.settings,e.opts),void 0!==i.settings.OFFERS&&!t.isEmptyObject(i.settings.OFFERS)){var s=i._getCheckedOffer();s>0&&(i.settings.checkedOffer=s),i.settings.checkedOffer>0&&(i._displayAllValues(),i._selectOfferByID(i.settings.checkedOffer))}})},i._initGallerySlider=function(){return new Swiper(i.UI.slider.container,{pagination:".swiper-pagination",paginationClickable:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",preloadImages:!0})},i._destroyGallerySlider=function(){t("#js-slider-wrapper").height(t(".item__slider").height()).animate({opacity:0},200),t("#js-slider").addClass("swiper-loader"),void 0!==i.swiper.slides&&i.swiper.slides.length>0&&i.swiper.removeAllSlides()},i._itemSliderSetHeightByImage=t.throttle(function(){var e=t(".item__slider .swiper-slide img").height();e>0&&(t(".item__slider .swiper-slide").height(e),t("#js-slider-wrapper").animate({opacity:1},300).height(e),t("#js-slider").removeClass("swiper-loader"))},200),i._itemSliderSetAutoHeight=t.throttle(function(){t(".item__slider .swiper-slide").height(t(".item__slider .swiper-slide").height())},200),i._detailLoaded=function(){i._itemSliderSetHeightByImage()},i._previewLoaded=function(){setTimeout(function(){t(i.UI.props+"PREVIEW_PICTURE",i).removeAttr("style")},200)},i._getSelectedColor=function(){var e="";return t.isEmptyObject(i.settings.checkedProps)?i.settings.checkedOffer>0:t.each(i.settings.checkedProps,function(t,s){if(void 0!==i.settings.PROPS[t]&&"COLOR_REF"==i.settings.PROPS[t].CODE&&void 0!==i.settings.PROPS[t].VALUES[s])return e=i.settings.PROPS[t].VALUES[s].XML_ID,!1}),e},i._getCheckedOffer=function(){var e=t.manageURL("getUrl"),s=0;if(void 0!==e.color_ref){var a=0,n=0;t.each(i.settings.PROPS,function(s,i){"color"==i.TYPE&&t.each(i.VALUES,function(t,i){if(i.COLOR==e.color_ref)return n=s,a=t,!1})}),a>0&&n>0&&(s=i._findFirstOfferByPropValue(n,a),i.settings.selectedColor=e.color_ref)}return s},i._findFirstOfferByPropValue=function(e,s){var a=0,n=0;return t.each(i.settings.OFFERS,function(t,i){if(void 0!==i.TREE["PROP_"+e]&&i.TREE["PROP_"+e]==s){if(i.CAN_BUY)return a=t,!1;n<=0&&(n=t)}}),a||(a=n),a},i._changeProp=function(t){var e=t.closest(i.UI.offers.block),s=e.data("id"),a=parseInt(t.data("id"));i.settings.checkedProps[s]=a,i._selectProp(s,a),i._findAvailablePropValues(s);var n=!1;"COLOR_REF"!=i.settings.PROPS[s].CODE?n=!0:(i.settings.selectedColor=i.settings.PROPS[s].VALUES[a].XML_ID,i._updateUrl(s,a)),i._selectOffer(n)},i._findAvailablePropValues=function(e){var s=i._getPropsToDisplay(e);0!=s.length&&t.each(s,function(e,s){var a=i.settings.checkedProps[s];i.settings.checkedProps[s]=0;var n=i._getPValuesToDisplay(s);t.inArray(a,n)<0&&(a=n.length>0?n[0]:i.settings.PROPS[s].VALUES_SORTED[0]),i._displayPropValues(s,n,a)})},i._selectOffer=function(e){i.settings.checkedOffer=0,t.each(i.settings.OFFERS,function(s,a){var n=!0;if(t.each(i.settings.checkedProps,function(t,e){a.TREE["PROP_"+t]!==e&&(n=!1)}),n){i.settings.checkedOffer=s,i._changeProperties(s,e);var o=a.CAN_BUY?a.MAX_QUANTITY:0;return o>0?i._setQuantityControl(o):i._setQuantityControl(1),i._getShops(),!1}}),0==i.settings.checkedOffer&&(i._changeProperties(0,e),i._setQuantityControl(0),i._getShops())},i._selectOfferByID=function(e){void 0===i.settings.OFFERS[e].TREE||t.isEmptyObject(i.settings.OFFERS[e].TREE)||(t.each(i.settings.OFFERS[e].TREE,function(t,e){t=t.replace("PROP_",""),i.settings.checkedProps[t]=e,i._selectProp(t,e),i._findAvailablePropValues(t)}),i.settings.selectedColor=i._getSelectedColor(),i._selectOffer())},i._getPropsToDisplay=function(e){var s=!1,a=[];return t.each(i.settings.PROPS_SORTED,function(t,i){s&&a.push(i),i==e&&(s=!0)}),a},i._getPValuesToDisplay=function(e){var s=[];return t.each(i.settings.OFFERS,function(a,n){var o=!0;return!!(n.MAX_QUANTITY<=0&&n.CHECK_QUANTITY)||(t.each(i.settings.checkedProps,function(t,e){e>0&&n.TREE["PROP_"+t]!==e&&(o=!1)}),void(o&&s.push(n.TREE["PROP_"+e])))}),s},i._displayPropValues=function(e,s,a){var n=t(i.UI.offers.block,i).filter('[data-id="'+e+'"]');if(n.html(""),void 0!==i.settings.PROPS[e].VALUES_SORTED&&i.settings.PROPS[e].VALUES_SORTED.length>0){var o=i.settings.PROPS[e].VALUES_SORTED,r=!1;r=a;var c=0;t.each(o,function(a,o){t.inArray(o,s)>-1?(r||c||(r=o),n.append(i._getPropValueHtml(e,o))):n.append(i._getPropValueHtml(e,o,!0)),c++}),i._selectProp(e,r),i.settings.checkedProps[e]=r}},i._displayAllValues=function(){return!(void 0==i.settings.PROPS_SORTED||i.settings.PROPS_SORTED.length<=0)&&void t.each(i.settings.PROPS_SORTED,function(e,s){var a=t(i.UI.offers.block,i).filter('[data-id="'+s+'"]');if(a.html(""),void 0!==i.settings.PROPS[s].VALUES_SORTED&&i.settings.PROPS[s].VALUES_SORTED.length>0){var n=i.settings.PROPS[s].VALUES_SORTED;t.each(n,function(t,e){a.append(i._getPropValueHtml(s,e))})}})},i._getPropValueHtml=function(t,e,s){var a="",n=i.settings.PROPS[t].VALUES[e],o="list__item js-product-offer-prop-item";if(s&&(o+=" disabled"),"color"==i.settings.PROPS[t].TYPE)o+=n.LIGHT?" white":" black",a='<li title="'+n.NAME+'" data-id="'+e+'" class="'+o+'">',void 0!==n.PICTURE&&(a+='<a  style="background-image: url('+n.PICTURE+')"></a>'),a+="</li>";else{var r=" - ",c=" - ",l=" - ";void 0!==i.settings.LIST_SIZES[n.NAME]&&(""!=i.settings.LIST_SIZES[n.NAME].EU&&(r=i.settings.LIST_SIZES[n.NAME].EU),""!=n.NAME&&(c=n.NAME),""!=i.settings.LIST_SIZES[n.NAME].FOOT&&(l=i.settings.LIST_SIZES[n.NAME].FOOT)),a='<li data-id="'+e+'" class="'+o+'"  data-size-eu="'+r+'" data-size-us="'+c+'" data-size-cm="'+l+'" title="'+n.DISPLAY+'"><a><span>'+n.DISPLAY+"</span></a></li>"}return a},i._selectProp=function(e,s){var a=t(i.UI.offers.block,i).filter('[data-id="'+e+'"]');a.data("type");if(a.find(i.UI.offers.item).removeClass("active").filter('[data-id="'+s+'"]').addClass("active").trigger("mouseenter"),void 0!==i.settings.PROPS[e]){var n=i.settings.PROPS[e].CODE;if(void 0!==i.settings.PROPS[e].VALUES[s]){var o=i.settings.PROPS[e].VALUES[s].NAME;i.settings.PROPS[e].VALUES[s].DISPLAY&&(o=i.settings.PROPS[e].VALUES[s].DISPLAY),t(i.UI.props+n,i).text(o)}}},i._changeProperties=function(e,s){if(e>0){i.data("productId",e).data("basketProps",i.settings.OFFERS[e].BASKET_PROPS);var a=0,n=0;void 0!==i.settings.OFFERS[e].PRICE.VALUE&&(a=i.settings.OFFERS[e].PRICE.PRINT_VALUE,t(i.UI.props+"OLD_PRICE",i).html(a+' <span class="cur">q</span>'),void 0!==i.settings.OFFERS[e].PRICE.DISCOUNT_VALUE&&(n=i.settings.OFFERS[e].PRICE.PRINT_DISCOUNT_VALUE,t(i.UI.props+"PRICE",i).html(n+' <span class="cur">q</span>'),a!=n?(t(".js-product-discount-block",i).show(),t(".js-product-price-block",i).hide()):(t(".js-product-discount-block",i).hide(),t(".js-product-price-block",i).show())))}if(i._manageBasketButton(),s!==!0&&void 0!==i.settings.SLIDER[i.settings.selectedColor])if(i._itemSliderSetAutoHeight(),i._destroyGallerySlider(),void 0!==i.swiper.slides&&setTimeout(function(){t.each(i.settings.SLIDER[i.settings.selectedColor].DETAIL,function(t,e){var s='<div class="swiper-slide" data-value="'+e.ID+'"><img id="'+e.ID+'" src="'+e.SRC+'" alt="" ';t||(s+=" onload=\"imgLoaded('detail')\""),s+="></div>",i.swiper.appendSlide(s)})},200),void 0!==i.settings.SLIDER[i.settings.selectedColor].PREVIEW){var o=t(i.UI.props+"PREVIEW_PICTURE",i),r=o.outerWidth()-.5;o.css({width:r,height:r}).html('<img src="'+i.settings.SLIDER[i.settings.selectedColor].PREVIEW+'" alt="" onload="imgLoaded(\'preview\')">')}else t(i.UI.props+"PREVIEW_PICTURE",i).html("");void 0!==i.settings.ARTNUMBER[i.settings.selectedColor]?t(i.UI.props+"ARTNUMBER",i).text(i.settings.ARTNUMBER[i.settings.selectedColor]):t(i.UI.props+"ARTNUMBER",i).text("")},i._selectQuantity=function(e){var s=parseInt(e.data("value"));s=i._checkQuantity(s),t(i.UI.quantity.input,i).val(s).change()},i._checkQuantity=function(t){if(t=parseInt(t),void 0!==i.settings.OFFERS[i.settings.checkedOffer]){var e=i.settings.OFFERS[i.settings.checkedOffer].MAX_QUANTITY;t>e&&(t=e)}return t},i._visualSelectQuantity=function(e){e=i._checkQuantity(e),e=e?e:1,t(i.UI.quantity.input,i).val(e),t(i.UI.quantity.selector,i).find(i.UI.quantity.item).filter('[data-value="'+e+'"]').addClass("active"),t(i.UI.quantity.display,i).text(e)},i._setQuantityControl=function(e){if(e>i.settings.defaultMaxQuantity&&(e=i.settings.defaultMaxQuantity),e>0){for(var s="",a=e;a>=1;a--)s+='<li class="list__item js-quantity-selector-item" data-value="'+a+'"><a>'+a+"</a></li>";t(i.UI.quantity.selector,i).html(s).closest(".js-selectors-item").removeClass("js-disabled"),i._visualSelectQuantity(1)}else t(i.UI.quantity.selector,i).closest(".js-selectors-item").addClass("js-disabled"),i._visualSelectQuantity(0)},i.refreshBasketContents=function(e,s){return this.each(function(){i.settings.inBasket=t.extend(i.settings.inBasket,e),s||i._manageBasketButton()})},i._manageBasketButton=function(){var e=i.settings.checkedOffer,s=t(i.UI.basket.button,i);e>0&&!i.settings.OFFERS[e].CAN_RESERVED&&t(i.UI.basket.blockInShops,i).hide(),e>0&&i.settings.OFFERS[e].CAN_BUY?(t(i.UI.notAvailable,i).hide(),t(i.UI.basket.blockInShops,i).removeClass("single-block"),t(i.UI.basket.block,i).css("display","inline-block"),void 0!==i.settings.inBasket[e]&&parseInt(i.settings.inBasket[e])>0?(s.hasClass(i.UI.basket.cAdded)||s.addClass(i.UI.basket.cAdded),s.find(i.UI.basket.title).html("в корзине")):(s.hasClass(i.UI.basket.cAdded)&&s.removeClass(i.UI.basket.cAdded),t(i.UI.basket.quantity,i).data("check",i.settings.OFFERS[e].CHECK_QUANTITY).data("max",i.settings.OFFERS[e].MAX_QUANTITY).val(1),s.find(i.UI.basket.title).html("В корзину"))):(t(i.UI.basket.block,i).hide(),i.settings.OFFERS[e].CAN_RESERVED&&t(i.UI.basket.blockInShops,i).addClass("single-block"),t(window).width()<768?t(i.UI.basket.blockInShops,i).css("display","block"):t(i.UI.basket.blockInShops,i).css("display","inline-block"))},i._getShops=function(){var e="",s="";void 0!==i.settings.selectedColor&&(s=i.settings.ARTNUMBER[i.settings.selectedColor]),t.each(i.settings.PROPS,function(t,s){"SIZES_SHOES"!=s.CODE&&"SIZES_CLOTHES"!=s.CODE||(e=s.VALUES[parseInt(i.settings.checkedProps[t])].NAME)}),t.post("/ajax/order_reserved.php",{id:i.settings.checkedOffer,check:"Y"}).done(function(e){e>0?(t(".js-quick-reserve").removeClass("disabled"),t(".js-quick-reserve").find(".js-product-basket-title").text("Забронировать в магазине")):(t(".js-quick-reserve").addClass("disabled"),t(".js-quick-reserve").find(".js-product-basket-title").text("Нет товара в магазинах"))}),t.post("/ajax/get_shops.php",{artnumber:s,size:e}).done(function(e){e.html&&t("#js-shops-container").html(e.html)})},i._reserveClick=function(e){ga("send","pageview","/virtual/shop_check");var s=i.settings.checkedOffer;t(i.UI.quantity.input,i).val();t.post("/ajax/order_reserved.php",{id:s,quantity:1}).done(function(s){t("#js-order-reserved").html(s),t(e).owOpenModal()})},i._buyOneClick=function(e){e.owOpenModal();var s=i.settings.checkedOffer,a=t(i.UI.quantity.input,i).val(),n=e.data("block");try{rrApi.addToBasket(s)}catch(o){}t.post("/ajax/buy_one_click_form.php",{id:s,quantity:a}).done(function(e){var s=t("#"+n);s.length>0&&(s.html(e.html),hidePlaceholder(),s.find("#phone").mask("+79999999999"),t("#js-quick-order-container").formAjax({},{ajax_name:"ow_quick_form_ajax",url:"/ajax/buy_one_click.php",validate:!0,dataType:"json",validateOptions:{ignore:""},callbacks:{onSuccess:function(e){s.find(".js-popup-close").click(),t("#js-quick-order-result-opener").owOpenModal()}}}))})},i._updateUrl=function(e,s){void 0!==i.settings.PROPS[e]&&void 0!==i.settings.PROPS[e].VALUES[s]&&t.manageURL({color_ref:i.settings.PROPS[e].VALUES[s].COLOR},!0)},"string"==typeof e&&"_"!=e[0]&&"function"==typeof i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:i.init.apply(this,arguments)}}(jQuery);
//# sourceMappingURL=maps/script(2).js.map
