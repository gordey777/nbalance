function textComment(){$(".js-reviews-item").each(function(){var t=$(this).find(".js-reviews-text").height(),e=$(this).find(".js-reviews-text-inner").height();e>t&&($(this).addClass("overflow"),$(this).find(".js-reviews-more").show().on("click",function(){var i=$(this).siblings(".js-reviews-text").height();$(this).children().toggle(),$(this).closest(".js-reviews-item").toggleClass("overflow"),i==t?$(this).siblings(".js-reviews-text").height(e):$(this).siblings(".js-reviews-text").height(t)}))})}function reviewsUpdateBlock(){$.ajax({data:{js_reviews_update_ajax:"Y"},type:"POST",url:window.location.pathname,dataType:"html",success:function(t){$("#js-product-reviews-block").html(t)},error:function(t,e){}})}!function(t){t.fn.reviewsPageNav=function(e,i){var o=this;return o.init=function(e){return this.each(function(){o.UI=t.extend({showNext:"#js-reviews-show-more",wrapper:".js-reviews-wrapper",reviewTemplate:t("#reviewTemplate").html()},e.UI),o.options=t.extend(!0,{curPage:1,maxPage:1,pageSize:10,firstPageSize:3,itemsCount:1,items:[],callbacks:{onPageChange:function(t,e){}}},e.opts),o._updateOptions(),textComment(),t(o.UI.showNext,o).click(function(t){t.preventDefault(),o._next()})})},o._getPagesLeftCount=function(){return o.options.itemsCount-o.options.firstPageSize-o.options.pageSize*(o.options.curPage-1)},o._next=function(e){o.options.maxPage>o.options.curPage&&(o.options.curPage++,o._displayItems(),o.options.callbacks.onPageChange(o.options.curPage,o.options.pageSize)),o.options.maxPage==o.options.curPage?t(o.UI.showNext,o).fadeOut(function(){t(this).remove()}):o.options.maxPage-o.options.curPage==1&&o._changeButtonText()},o._changeButtonText=function(){var e=o._getPagesLeftCount();e>o.options.pageSize&&(e=o.options.pageSize),t(o.UI.showNext,o).text("Показать еще "+e+pluralName(e,[" отзыв"," отзыва"," отзывов"]))},o._updateOptions=function(){o.options.itemsCount=o.options.items.length,o.options.maxPage=Math.ceil((o.options.itemsCount-o.options.firstPageSize)/o.options.pageSize)+1,o.options.curPage>o.options.maxPage&&(o.options.curPage=o.options.maxPage),o._changeButtonText()},o._displayItems=function(){var e=t(o.UI.wrapper,o),i={ITEMS:[]},s=(o.options.curPage-2)*o.options.pageSize+o.options.firstPageSize,n=(o.options.curPage-1)*o.options.pageSize+o.options.firstPageSize-1;n>=o.options.items.length&&(n=o.options.items.length-1);for(var a=s;a<=n;a++)void 0!==o.options.items[a]&&(o.options.items[a].displayRating=o.options.stars.active.repeat(o.options.items[a].rating)+o.options.stars["default"].repeat(5-o.options.items[a].rating)),i.ITEMS.push(o.options.items[a]);i.ITEMS.length>0&&(e.append(Mustache.render(o.UI.reviewTemplate,i)),textComment())},"string"==typeof e&&"_"!=e[0]&&"function"==typeof o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:o.init.apply(this,arguments)}}(jQuery);
//# sourceMappingURL=maps/script(4).js.map
